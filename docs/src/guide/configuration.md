---
title: Configuration
icon: weui:setting-filled
order: 4
---

The [`YouTubeSessionGenerator`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html) class can be customized using the [`YouTubeSessionConfig`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionConfig.html) object passed to its constructor. This page outlines all available options and how to use them effectively.

```cs
YouTubeSessionGenerator generator = new(new YouTubeSessionConfig()
{
    JsEnvironment = new NodeEnvironment(),  // or any custom IJsEnvironment
    HttpClient = new HttpClient(),
    Logger = logger
});
```


## JsEnvironment
To generate a [Proof of Origin Token](../guide/#proof-of-origin-token) and bypass YouTube’s anti-bot system, [BotGuard](https://botguard.net/en/home), you need to execute custom JavaScript code in an environment that supports the [DOM](https://de.wikipedia.org/wiki/Document_Object_Model) (access to `window` & `document`).
- Type: [`IJsEnvironment`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/Js/IJsEnvironment.html)
- Required for [`CreateProofOfOriginTokenAsync`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html#createproofoforigintokenasync)
- If omitted, methods like [`CreateVisitorDataAsync`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html#createvisitordataasync) & [`CreateRolloutTokenAsync`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html#createrollouttokenasync) will still work.

```cs
using YouTubeSessionGenerator.Js.Environments;

config.JsEnvironment = new NodeEnvironment("C:\\Program Files\\nodejs\\node.exe");
```

#### Built-in
The built-in environment uses [Node.js](https://nodejs.org) under the hood, and supports Windows, Linux & macOS.

::: details Why not use a .NET JavaScript interpreter?
You might be wondering: *Why not use a .NET-based JavaScript engine like [Jint](https://github.com/sebastienros/jint), instead of depending on the bulkier [Node.js](https://nodejs.org) runtime?*

It’s a fair question. In theory, using something like [Jint](https://github.com/sebastienros/jint) would make the library fully self-contained and cross-platform with no external dependencies.

However, generating valid **Proof of Origin tokens** requires more than just executing JavaScript - it requires simulating a realistic browser-like environment. Tools like [AngleSharp.js](https://github.com/AngleSharp/AngleSharp.js) try to replicate the [DOM](https://de.wikipedia.org/wiki/Document_Object_Model) with support for realastic JavaScript execution, but sadly these projects are not quite mature yet. Another thing we can try is to port Js-libraries like [jsdom](https://github.com/jsdom/jsdom) or [happy-dom](https://github.com/capricorn86/happy-dom) to pure JavaScript - without the dependecies of the  [Node](https://nodejs.org) environment. Unfortunately, even after doing that, integrity tokens generated by [BotGuard](https://botguard.net/en/home) were still invalid and no WebPo minter was created, which is required for minting poTokens.

The problem probably lies in subtle but critical differences:
- [Jint](https://github.com/sebastienros/jint) lacks a proper event loop and microtasks/macrotasks queues
- Available .NET [DOM](https://de.wikipedia.org/wiki/Document_Object_Model) simulations aren't full-featured enough for [BotGuard](https://botguard.net/en/home)'s fingerprinting
- Key APIs like `setTimeout`, `setInterval`, `performance.now()`, or [Node](https://nodejs.org)'s `vm` module aren't available

After investing **far too many hours** trying to make it work, I ultimately opted for a small [Node.js](https://nodejs.org) subprocess instead. It’s still much lighter than bundling a full headless browser like [Chromium](https://www.chromium.org/), and it *actually works*.

That said, this project is open-source - so if you can get it working with a pure .NET engine, I’d love to see a pull request :3
:::

#### Custom
If you're targeting other platforms than Windows, Linux or macOS, you can implement your own JavaScript execution logic - e.g., by using a headless browser or a cloud-based JavaScript environment. To do this, you’ll need to implement the [`IJsEnvironment`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/Js/IJsEnvironment.html) interface:
```cs
using YouTubeSessionGenerator.Js;

public class CustomJsEnvironment : IJsEnvironment
{
    Task<string?> ExecuteAsync(JsScript script);
    {
        string code = script.Code;
        object?[] args = script.Args;

        // Execute the code with the given args..
    }
}
```
Make sure your custom environment supports the [DOM](https://de.wikipedia.org/wiki/Document_Object_Model) and passes all tests in the [test suite](https://github.com/IcySnex/YouTubeSessionGenerator/blob/main/YouTubeSessionGenerator.Tests/Js/NodeEnvironmentTests.cs).


## HttpClient
You can inject a shared or customized HTTP client into the [`YouTubeSessionGenerator`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html), e.g., for timeouts or proxy support. This client is used to send all HTTP requests to YouTube and Google servers.
- Type: [`HttpClient`](https://learn.microsoft.com/dotnet/api/system.net.http.httpclient)
- if omitted, a default instance will be created.

```cs
using System.Net;

HttpClientHandler proxyHandler = new()
{
    Proxy = new WebProxy("http://proxyserver:80/", true)
};

config.HttpClient = new(proxyHandler)
{
    Timeout = TimeSpan.FromSeconds(30)
};
```


## Logger
**YouTubeSessionGenerator** uses a standard logger to output progress, debug information and error messages. It’s built on top of [Microsoft.Extensions.Logging](https://learn.microsoft.com/dotnet/core/extensions/logging), so you can easily integrate it with any logging provider (e.g., Console, Debug, File, Serilog, etc.).
- Type: [`ILogger`](https://learn.microsoft.com/dotnet/api/microsoft.extensions.logging.ilogger)
- if omitted, logging is simply disabled.

```cs
using Microsoft.Extensions.Logging;

ILoggerFactory factory = LoggerFactory.Create(builder =>
{
    builder.AddConsole();
});

config.Logger = factory.CreateLogger("YouTubeSessionGenerator");
```