---
title: Configuration
icon: weui:setting-filled
order: 4
---

The `YouTubeSessionGenerator` class can be customized using the `YouTubeSessionConfig` object passed to its constructor. This page outlines all available options and how to use them effectively.

```cs
YouTubeSessionGenerator generator = new(new YouTubeSessionConfig()
{
    JsEnvironment = new NodeEnvironment(),  // or any custom IJsEnvironment
    HttpClient = new HttpClient(),
    Logger = logger
});
```


## JsEnvironment
To generate a [Proof of Origin Token](../guide/#proof-of-origin-token) and bypass YouTube’s anti-bot system, [BotGuard](https://botguard.net/en/home), you need to execute custom JavaScript code in an environment that supports the DOM (access to `window` & `document`).
- Type: [`IJsEnvironment`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/Js/IJsEnvironment.html)
- Required for [`CreateProofOfOriginTokenAsync`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html#createproofoforigintokenasync)
- If omitted, methods like [`CreateVisitorDataAsync`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html#createvisitordataasync) & [`CreateRolloutTokenAsync`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/YouTubeSessionGenerator.html#createrollouttokenasync) will still work.

```cs
using YouTubeSessionGenerator.Js.Environments;

config.JsEnvironment = new NodeEnvironment("C:\\Program Files\\nodejs\\node.exe");
```

#### Built-in
The built-in environment uses [Node.js](https://nodejs.org) under the hood, and supports Windows, Linux & macOS.

::: details Why not use a .NET JavaScript interpreter?
You might ask: why not just use a cross-platform, fully .NET JavaScript engine like [Jint](https://github.com/sebastienros/jint), instead of relying on the bulky Node runtime?

The main reason is that YouTube's anti-bot protection requires a real browser-like environment. Okay - so let’s simulate one. There are libraries like [happy-dom](https://github.com/capricorn86/happy-dom) or [jsdom](https://github.com/jsdom/jsdom) that can, in theory, be integrated with [Jint](https://github.com/sebastienros/jint). In addition to that there are .NET projects like [AngleSharp.Js](https://github.com/AngleSharp/AngleSharp.Js) which *should be able* to simulate a DOM, but sadly those projects are not quite mature yet.

But even after getting [happy-dom](https://github.com/capricorn86/happy-dom) to successfully run inside [Jint](https://github.com/sebastienros/jint), the tokens generated by [BotGuard](https://botguard.net/en/home) were still invalid and no WebPo minter was generated. This is likely because [Jint](https://github.com/sebastienros/jint) lacks a fully functioning microtask/macrotask queue and an event loop that automatically processes deferred work - all of which are crucial for accurate simulation of browser behavior. Additionally, other issues arise like missing important functions like `setTimeout`, `setInterval` or `performance.now()`, no support for Nodes `vm`'s' and issues with spoofing environmental fingerprinting.

After spending **way too many** hours trying to make it work, I decided to stick with a [Node.js](https://nodejs.org) subprocess instead. It’s still much lighter than bundling a full headless browser like [Chromium](https://www.chromium.org/).

That said, this project is open-source—so if you can prove me wrong and get it working in pure .NET, I’d love to see a pull request!
:::

#### Custom
If you're targeting other platforms than Windows, Linux or macOS, you can implement your own JavaScript execution logic - e.g., by using a headless browser or a cloud-based JavaScript environment. To do this, you’ll need to implement the [`IJsEnvironment`](/YouTubeSessionGenerator/reference/YouTubeSessionGenerator/Js/IJsEnvironment.html) interface:
```cs
using YouTubeSessionGenerator.Js;

public class CustomJsEnvironment : IJsEnvironment
{
    Task<string?> ExecuteAsync(JsScript script);
    {
        string code = script.Code;
        object?[] args = script.Args;

        // Execute the code with the given args..
    }
}
```
Make sure your custom environment supports the DOM and passes all tests in the [test suite](https://github.com/IcySnex/YouTubeSessionGenerator/blob/main/YouTubeSessionGenerator.Tests/Js/NodeEnvironmentTests.cs).


## HttpClient
You can inject a shared or customized HTTP client into the [`YouTubeSessionGenerator`](/YouTubeSessionGenerator/YouTubeSessionGenerator.cs), e.g., for timeouts or proxy support. This client is used to send all HTTP requests to YouTube and Google servers.
- Type: [`HttpClient`](https://learn.microsoft.com/dotnet/api/system.net.http.httpclient)
- if omitted, a default instance will be created.

```cs
using System.Net;

HttpClientHandler proxyHandler = new()
{
    Proxy = new WebProxy("http://proxyserver:80/", true)
};

config.HttpClient = new(proxyHandler)
{
    Timeout = TimeSpan.FromSeconds(30)
};
```


## Logger
YouTubeSessionGenerator uses a standard logger to output progress updates, debug information and error messages. It’s built on top of [Microsoft.Extensions.Logging](https://learn.microsoft.com/dotnet/core/extensions/logging), so you can easily integrate it with any logging provider (e.g., Console, Debug, File, Serilog, etc.).
- Type: [`ILogger`](https://learn.microsoft.com/dotnet/api/microsoft.extensions.logging.ilogger)
- if omitted, logging is simply disabled.

```cs
using Microsoft.Extensions.Logging;

ILoggerFactory factory = LoggerFactory.Create(builder =>
{
    builder.AddConsole();
});

config.Logger = factory.CreateLogger("YouTubeSessionGenerator");
```